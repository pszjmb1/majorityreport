<template name='freeform'>
    {{> tools}}
    <div id="board">
        {{#each provHadMember}}
            {{#with entityWithAttributes}}
                {{> entity}}
            {{/with}}
        {{/each}}
    </div>
</template>

<template name="entity">
    <div id="{{ this.entity.mrOrigin }}" class="entity-outer" style="{{entityAttributes 'outer'}}">
        <div class="entity-inner entity-item-{{entityType}}"  style="{{entityAttributes}}">
               {{> UI.dynamic template=entityType data=this.entity }}
        </div>
        <button class="entity-info btn btn-default btn-xs"><i class="fa fa-info-circle"></i> Info</button>
        <div class="connector"></div>
    </div>
</template>

<template name="textEntity">
    {{mrContent}}
</template>

<template name="imageEntity">
    <img src="{{provAtLocation}}" />
</template>

<template name="mapEntity">
    <div id="{{mrOrigin}}-map" class="map"></div>
</template>

<template name="entityInfo">
    {{#with latestVersion}}
        {{!-- Only show relation control and list for markers or other specific scenarios --}}
        <div class="entity-info-tools">
            <a class="btn btn-default btn-xs add-atrribute"><i class="fa"></i>Add Attribute</a>
            {{#if showRelations}}
                <a class="btn btn-default btn-xs add-relation"><i class="fa"></i>Add Relation</a>
            {{/if}}
        </div>
        {{> displayAttributes this}}
        {{#if showRelations}}
            {{> displayRelations this}}
        {{/if}}
    {{/with}}
    
</template>

<template name="displayAttributes">
    {{#if isValid attributes}}
        <div class="attributes">
            <h4>Attributes</h4>
            {{#each attributes}}
                <span class="label label-info">{{label}}: {{value}}  <a href="#" class="remove-attribute">x</a> </span>
            {{/each}}
        </div>
    {{/if}}
</template>

<template name="displayRelations">
    {{#if isValid relations}}
        <div class="relations">
            <h4>Relatives</h4>
            {{#each relations 'mrTarget'}}
                <span class="relative-entity-item">{{> displayThumbnail getEntity mrTarget}}</span>
            {{/each}}
        </div>
    {{/if}}
</template>

<template name="displayThumbnail">
    {{#if isEntityType "image"}}
        <img src="{{provAtLocation}}" class="entity-thumbnail entity-thumbnail-media">
    {{else}} {{#if isEntityType "map"}}
        <i class="fa fa-globe fa-3x"></i>
    {{/if}}{{/if}}
</template>

<template name="formAttribute">
    <div>
        <form>
            <input type="text" name="attribute-label" id="attribute-label" placeholder="{{label}}"/>
            <input type="text" name="attribute-value" id="attribute-value" placeholder="{{value}}"/>
            <button class="btn btn-success btn-sm" type="submit"><i class="fa fa-plus-circle"></i>Save Annotation</button>
        </form>
    </div>
</template>


<template name="tools">
    {{!-- Text --}}
    <div class="btn-group">
        <button type="button" class="entity-text btn dropdown-toggle" data-toggle="dropdown">
            <i class="fa fa-align-left"></i> Add Text <span class="caret"></span>
        </button>
        <div class="dropdown-menu dropdown-form" role="menu">
            <form name="text">
                <textarea name="textContent" cols="20" rows="5"></textarea>
                <button class="btn" type="submit">Submit</button>
            </form>
        </div>
    </div>
    {{!-- Media (images/videos/audios) --}}
    <div class="btn-group">
        <form name="media" class="form-inline">
            <div class="input-group">
                <input type="textfield" class="form-control" placeholder="Media URL" name="mediaUrl" />
                <div class="input-group-btn">
                    <select class="form-control" name="mediaFormat">
                        <option value="image/jpeg">Image (.jpg)</option>
                        <option value="video/flv">Video (flv)</option>
                        <option value="video/fla">Video (fla)</option>
                    </select>
                    <button class="btn" type="submit"><i class="fa fa-image"></i>  Add Media</button>
                </div>      
            </div>
        </form> 
    </div>    
    {{!-- Maps --}}
    <button type="button" class="entity-map btn"><i class="fa fa-map-marker"></i> Add Map</button>
    {{!-- Misc. --}}
    <button type="button" class="entity-group btn"><i class="fa fa-folder-open-o"></i> Group</button>
</template>